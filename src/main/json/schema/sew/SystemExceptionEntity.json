{
  "$id": "https://example.com/calendar.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "SystemExceptionEntity MongoDB",
  "title": "SystemExceptionEntity MongoDB Title",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "description": "Generated surrogate key."
    },
    "endpoint": {
      "type": "string",
      "description": "The topic or http endpoint that should be used for retries"
    },
    "endpointType": {
      "type": "string",
	  "description": "The type of the endpoint.",
	  "enum": ["Topic","HTTP"]
    },
    "payload": {
      "type": "any",
	  "description": "The payload provided by the exception producer."
    },
    "headers": {
      "type": "object",
	  "$ref": "#/definitions/HeaderType"
    },
    "exceptionMessage": {
      "type": "string",
      "description": "The message of the exception that occurred."
    },
    "stackTrace": {
      "type": "string",
      "description": "The pipe delimited stack trace of the exception that occurred."
    },
    "replayPayload": {
      "type": "string",
      "description": "The updated payload used for replay."
    },
    "replayHeaders": {
      "$ref": "#/definitions/HeaderType",
	  "description": "The updated headers used for replay."
    },
    "lastModifiedUser": {
      "type": "string",
	  "description": "The last modified user."
    },
	"lastUpdatedTimeStamp": {
	  "description": "The last updated timestamp.",
	  "format":"date-time",
	  "type": "string"
    },
	"status": {
	  "description": "it's Open/Abandon/Replay.",
	  "type":"string",
	  "pattern": "Open|Replay|Abandon"
    },
	"hidden": {
		  "description": "Hide Or snooze the exception",
		  "type": "string",
		  "pattern": "Y/N"

	  },
	"notes": {
	  "description": "The note and comment.",
	  "type":"string"
	},
	"ticketNumber": {
		  "description": "The ticket number provided to track for Exception procession",
		  "type":"string"
	  },
	"additionalDataEndpoint": {
		  "description": " (Optional) The callback endpoint to fetch additional information about an exception",
		  "type":"string"
	  },
	"traceId": {
		  "type": "string",
		  "description": "Trace Id to track the exception al any business process failures"
	  },
	"assignedUsers": {
		"description": "The audit history of this System Exception event",
		"$ref": "UserDetails.json"
	  },
	"historicalSystemExceptions": {
	  "description": "The audit history of this System Exception event",
	  "$ref": "AuditHistoryDetails.json"
		},
	"batchConfirmationId": {
		  "description": "The scheduled processed batch id",
		  "type":"string"
	  },
	"actionConfirmationId": {
		  "description": "The bulk processed (Replay/Abandon) unique id",
		  "type":"string"
	  },
	"exceptionCodes": {
		  "description": "Expected Error Codes to find out the respected Resolution steps",
		  "type":"array",
		  "items": {"type": "string"}
	  },
	"resolutionCodes": {
		  "description": "Expected Resolution steps",
		  "type":"array",
		  "items": {"type": "string"}
	  },
	"exceptionValidationStatus": {
		  "description": "Validating incoming exception and set if it is valid or missing any required information",
		  "type":"boolean"
	  },
	"discardReason": {
		  "description": "Reason about missing any required information",
		  "type":"string"
	  }
  },
  "required": [ "endpoint", "endpointType", "payload", "headers", "exceptionMessage", "stackTrace" ],
  "definitions" :{
	  "HeaderType" :{
		  "type": "object",
		  "properties": {
			  "creationTimeStamp": {
				  "description": "SEAR header: ISO-8601 formatted timestamp marking the UTC intstant that the message is created",
				  "type": "string",
				  "format": "date-time"
			  },
			  "senderApplicationId": { 
					"description": "Sear header: The sender application ID.",
					"type": "string"
				},
			  "senderSubApplicationId": {
					"description": "Sear header: The sender sub application ID.",
					"type": "string"
				},
			  "senderHostName": {
					"description": "Sear header: The Host name of the machine from which the message originated.",
					"type": "string"
				},
			  "senderMessageId": {
					"description": "Sear header: Unique identifier of the message. Should be a GUID.",
					"type": "string"
				},
			  "transactionId": {
					"description": "Sear header: The originator of a cross component transaction should use GUID.",
					"type": "string"
				},
			  "teamMemberId": {
					"description": "Sear header: If a Human user can be identified as the initiator of the work.",
					"type": "string"
				},
			  "teamMemberIdType": {
					"description": "Sear header: If teamMemberId is provided, this header must also be provided to indicate the type.",
					"type": "string",
					"pattern": "ELID|HRIS|AD|PPID|SAF"
				},
			  "businessProcessId":{
					"description": "Sear header: Identifiers an event. Used by a consumer to differentiate payloads originating from the sear.",
					"type": "string"
				},
			  "productIdentifier":{
					"description": "Sear header: Uniquely Identifiers the product payload is related to. In the general case",
					"type": "string"
				},
			  "eventName":{
				  "description": "SEAR header: Event name header would help consumers understand the intent of a payload before fully processing/deserializing it",
				  "type": "string",
				  "format": "string"
			  }
		  },
		  "required": [ "creationTimeStamp", "productIdentifier" ]
	  }
  }
}